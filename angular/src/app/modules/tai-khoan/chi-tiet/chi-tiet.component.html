<div class="wrapper wrapper-content animated fadeInRight">
  <div class="ibox">
    <div class="ibox-title">
      <h5>Lược Sử</h5>
    </div>
    <div class="ibox-content {{isLoading ? 'sk-loading' : null}}">
      <div class="sk-spinner sk-spinner-three-bounce">
        <div class="sk-bounce1"></div>
        <div class="sk-bounce2"></div>
        <div class="sk-bounce3"></div>
      </div>
      <div class="row" *ngIf="taiKhoanInfo">
        <div class="col-md-5">
          <div class="contact-box center-version">
            <a>
              <img alt="image" class="img-circle" src="{{webAPI}}/{{taiKhoanID}}/anh-ca-nhan">
              <h3 class="m-b-xs"><strong>{{taiKhoanID}}</strong></h3>
              <div class="font-bold">{{taiKhoanInfo.ten_thanh}} {{taiKhoanInfo.ho_va_ten}}</div>
            </a>
          </div>
        </div>
        <div class="col-md-7" *ngIf="taiKhoanInfo.lop_hoc && taiKhoanInfo.lop_hoc.length">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Lớp</th>
                  <th>Xem</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let _item of taiKhoanInfo.lop_hoc| paginate: pState; let _i = index">
                  <td>{{_item.ten_lop}}</td>
                  <td>
                    <a class="btn btn-xs btn-default" [routerLink]="['/lop-hoc/chi-tiet', _item.id]">Lớp</a>
                    <button class="btn btn-xs btn-default" (click)="itemSelected = _item; openModalBtn.click()">H/Trưởng</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <pagination-template #ep="paginationApi" [id]="pState.id" (pageChange)="pState.currentPage = $event;">
            <div class="text-center">
              <div class="btn-group">
                <button *ngIf="ep.isFirstPage()" type="button" class="btn btn-sm btn-white disabled"><i class="fa fa-chevron-left"></i></button>
                <button (click)="ep.previous()" *ngIf="!ep.isFirstPage()" type="button" class="btn btn-sm btn-white"><i class="fa fa-chevron-left"></i></button>
                <ng-container *ngFor="let page of ep.pages">
                  <button *ngIf="ep.getCurrent() !== page.value" (click)="ep.setCurrent(page.value)" class="btn btn-sm btn-white">{{ page.label }}</button>
                  <button *ngIf="ep.getCurrent() === page.value" class="btn btn-sm btn-white active">{{ page.label }}</button>
                </ng-container>
                <button *ngIf="ep.isLastPage()" type="button" class="btn btn-sm btn-white disabled"><i class="fa fa-chevron-right"></i></button>
                <button (click)="ep.next()" *ngIf="!ep.isLastPage()" type="button" class="btn btn-sm btn-white"><i class="fa fa-chevron-right"></i></button>
              </div>
            </div>
          </pagination-template>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="tab === 'chi-tiet'" class="ibox">
    <div class="ibox-title">
      <h5>Thông Tin</h5>
    </div>
    <div class="ibox-content {{isLoading ? 'sk-loading' : null}}">
      <div class="sk-spinner sk-spinner-three-bounce">
        <div class="sk-bounce1"></div>
        <div class="sk-bounce2"></div>
        <div class="sk-bounce3"></div>
      </div>
      <div *ngIf="taiKhoanInfo">
        <form action="#" class="row form-horizontal">
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.id">
            <label class="col-sm-6 control-label">Mã Số</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.id}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.ten_thanh">
            <label class="col-sm-6 control-label">Tên Thánh</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.ten_thanh}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.ho_va_ten">
            <label class="col-sm-6 control-label">Họ và Tên</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.ho_va_ten}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.trang_thai">
            <label class="col-sm-6 control-label">Trạng Thái</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.trang_thai | trangThai}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.loai_tai_khoan">
            <label class="col-sm-6 control-label">Loại Tài Khoản</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.loai_tai_khoan | loaiTK}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.gioi_tinh">
            <label class="col-sm-6 control-label">Giới Tính</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.gioi_tinh | gioiTinh}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.ngay_sinh">
            <label class="col-sm-6 control-label">Ngày sinh</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.ngay_sinh | ngay}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.ngay_rua_toi">
            <label class="col-sm-6 control-label">Ngày Rửa Tội</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.ngay_rua_toi | ngay}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.ngay_ruoc_le">
            <label class="col-sm-6 control-label">Ngày Ruớc Lễ</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.ngay_ruoc_le | ngay}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.ngay_them_suc">
            <label class="col-sm-6 control-label">Ngày Thêm Sức</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.ngay_them_suc | ngay}}</p>
            </div>
          </div>
          <div class="form-group col-sm-6" *ngIf="taiKhoanInfo.email">
            <label class="col-sm-6 control-label">Email</label>
            <div class="col-sm-6">
              <p class="form-control-static">{{taiKhoanInfo.email}}</p>
            </div>
          </div>
          <div class="form-group col-sm-12" *ngIf="taiKhoanInfo.dia_chi">
            <label class="col-sm-3 control-label">Địa Chỉ</label>
            <div class="col-sm-9">
              <p class="form-control-static">{{taiKhoanInfo.dia_chi}}</p>
            </div>
          </div>
          <div class="form-group col-sm-12" *ngIf="taiKhoanInfo.ghi_chu">
            <label class="col-sm-3 control-label">Ghi Chú</label>
            <div class="col-sm-9">
              <p class="form-control-static" [innerHtml]="taiKhoanInfo.ghi_chu | newline"></p>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="ibox-footer" *ngIf="hasPerm()">
      <button class="btn btn-primary btn-sm m-l-lg" (click)="tab = 'form'">Cập Nhật Thông Tin</button>
      <button class="btn btn-primary btn-sm m-l-lg" (click)="tab = 'mat-khau'">Đổi Mật Khẩu</button>
    </div>
  </div>
  <div *ngIf="tab === 'form'" class="ibox">
    <app-form (updateInfo)="update($event)" [curAuth]="curAuth" [taiKhoanInfo]="taiKhoanInfo"></app-form>
  </div>
  <div *ngIf="tab === 'mat-khau'" class="ibox">
    <app-mat-khau (updateInfo)="update($event)" [taiKhoanInfo]="taiKhoanInfo"></app-mat-khau>
  </div>
</div>

<a class="btn-open-modal" data-toggle="modal" data-target="#tmpModel" #openModalBtn></a>
<div class="modal inmodal" id="tmpModel" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" *ngIf="itemSelected">
    <div class="modal-content animated bounceInRight">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span>
          <span class="sr-only">Close</span>
        </button>
        <h5 class="modal-title">
          {{itemSelected.ten_lop}}
        </h5>
      </div>
      <div class="modal-body">
        <table class="table table-striped table-bordered table-hover">
          <thead>
            <tr>
              <th class="text-center">#</th>
              <th>Huynh Trưởng</th>
              <th>Điện Thoại</th>
              <th>Xem</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let _item of itemSelected.huynh_truong; let _i = index">
              <td class="text-center">
                {{_i + 1}}
              </td>
              <td>
                {{_item.ten_thanh}} {{_item.ho_va_ten}}
              </td>
              <td>
                {{_item.dien_thoai}}
              </td>
              <td>
                <a (click)="closeModalBtn.click(); xemTaiKhoan(_item)" class="btn btn-xs btn-default">
                  Xem
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default btn-sm" data-dismiss="modal" #closeModalBtn>Thoát</button>
      </div>
    </div>
  </div>
</div>